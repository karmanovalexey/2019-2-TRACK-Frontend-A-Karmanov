(this["webpackJsonptrack-mail-2019-alexis"]=this["webpackJsonptrack-mail-2019-alexis"]||[]).push([[0],[,function(e,a,t){e.exports={conv_window:"chat_conv_window__2KrEG",message_container:"chat_message_container__12Tb4",message_form:"chat_message_form__2zrqE","add-message-animation":"chat_add-message-animation__3b0RX",form_input:"chat_form_input__1oRac",conv_head:"chat_conv_head__3v4WA",top_line:"chat_top_line___yO2U",back:"chat_back__3-jXj",back_icon:"chat_back_icon__3Xove",interlocutor:"chat_interlocutor__1DPq6",interlocutor_icon:"chat_interlocutor_icon__1UN3y",interlocutor_info:"chat_interlocutor_info__2P35c",interlocutor_name:"chat_interlocutor_name__175_3",interlocutor_time:"chat_interlocutor_time__2t_4A",search:"chat_search__12bYd",search_icon:"chat_search_icon__2c3cg",more:"chat_more__NpJjx",more_icon:"chat_more_icon__nG_HT",bubble:"chat_bubble__fNeuv",text:"chat_text__dtU1A",time:"chat_time__37g3P",line_block:"chat_line_block__1ivE7",buttons:"chat_buttons__raaGI",attach:"chat_attach__37eQ6",attach_icon:"chat_attach_icon__1Kzy1",send:"chat_send__N3tDE",send_icon:"chat_send_icon__1y5Jt"}},function(e,a,t){e.exports={chatform:"list_chatform__2CSIC",createchat:"list_createchat__3E231",createchaticon:"list_createchaticon__2sioQ",chatbutton:"list_chatbutton__1GtBd",profile:"list_profile__2pgWw",name_message:"list_name_message__khKnN",name:"list_name__tU3qg",message:"list_message__ztDQ5",time_status:"list_time_status__3vdLJ",time:"list_time__3V7Rv",search:"list_search__1HPTR",searchicon:"list_searchicon__2h3jC",burger:"list_burger__3tE8H",burgericon:"list_burgericon__1WWd7",header:"list_header__1G5Fm",interlocutor:"list_interlocutor__cKKhI",interlocutor_icon:"list_interlocutor_icon__3zwI7",chatlisthead:"list_chatlisthead__BZ4Ab",chatlistcontent:"list_chatlistcontent__2BXlX",chat_list:"list_chat_list__20i0s"}},,function(e,a,t){e.exports={edit:"profile_edit__20ox6",edit_icon:"profile_edit_icon__2VK_A",tick:"profile_tick__rFpWo",tick_icon:"profile_tick_icon__3okf0",profile_manager:"profile_profile_manager__1QI-P",top_line:"profile_top_line__31QDg",back:"profile_back__1NT9K",back_icon:"profile_back_icon__3XONf",profile_content:"profile_profile_content__3cWVo",photo:"profile_photo__3pnAS",photo_icon:"profile_photo_icon__2u4D4",full_name:"profile_full_name__2t0Vw",nameViewer:"profile_nameViewer__3wKvF",username:"profile_username__3AvhX",usernameViewer:"profile_usernameViewer__17v2N",bio:"profile_bio__mkayb",bioViewer:"profile_bioViewer__2Tzdw"}},,,,,,,,function(e,a,t){e.exports=t.p+"static/media/user.36bad004.svg"},,function(e,a,t){e.exports=t.p+"static/media/search.9c5fa42b.svg"},function(e,a,t){e.exports=t.p+"static/media/edit.1b81f274.svg"},function(e,a,t){e.exports=t.p+"static/media/back.dd28c577.svg"},,,,,,,,,,,function(e,a,t){e.exports=t.p+"static/media/menu_list.c98ab14f.svg"},,,function(e,a,t){e.exports=t.p+"static/media/more.cc6a05bc.svg"},function(e,a,t){e.exports=t.p+"static/media/paper-plane.67b680c2.svg"},function(e,a,t){e.exports=t.p+"static/media/attachment.79ae74dd.svg"},function(e,a,t){e.exports=t.p+"static/media/geo.f57da586.svg"},function(e,a,t){e.exports=t.p+"static/media/audio.2af06a61.svg"},function(e,a,t){e.exports=t.p+"static/media/stop.43b68a51.svg"},function(e,a,t){e.exports=t.p+"static/media/tick.4f7c9356.svg"},,,function(e,a,t){e.exports=t(51)},,,,,,,,,,,function(e,a,t){},function(e,a,t){"use strict";t.r(a);var n=t(0),c=t.n(n),i=t(23),r=t.n(i),o=t(10),s=t(5),l=t(24),m=t(25),_=t(37),u=t(26),d=t(38),p=t(7),f=t(2),g=t.n(f),h=t(27),b=t.n(h),v=t(14),E=t.n(v),N=t(12),k=t.n(N);var y=function(){return c.a.createElement("div",{className:g.a.chatlisthead},c.a.createElement("button",{className:g.a.burger},c.a.createElement("img",{className:g.a.burgericon,src:b.a,alt:"menu"})),c.a.createElement(p.b,{to:"/profile",className:g.a.interlocutor},c.a.createElement("img",{className:g.a.interlocutor_icon,src:k.a,alt:"interlocutor"})),c.a.createElement("div",{className:g.a.header},"Chats"),c.a.createElement("button",{className:g.a.search},c.a.createElement("img",{className:g.a.searchicon,src:E.a,alt:"search"})))},x=t(8);var w=function(e){return c.a.createElement(p.b,{to:"/chat_id=".concat(e.id),className:g.a.chatform},c.a.createElement("div",{className:g.a.chatbutton},c.a.createElement("button",{className:g.a.profile}),c.a.createElement("div",{className:g.a.name_message},c.a.createElement("div",{className:g.a.name},e.companionName),c.a.createElement("div",{className:g.a.message},e.message)),c.a.createElement("div",{className:g.a.time_status},c.a.createElement("div",{className:g.a.time},e.time),c.a.createElement("div",{className:g.a.status},"!"))))},O=t(15),T=t.n(O),S="Chats";var j=function(e){var a=0,t=Object(n.useState)(function(){setTimeout((function(){s.current.scrollTop=9999}),0);var e=JSON.parse(localStorage.getItem(S));if(null!==e){for(var t=[];a<e.length;a+=1){var n=l(e[a]);t.push(c.a.createElement(w,{key:n.key,id:n.id,indicator:n.indicator,lastmessageText:n.lastmessageText,lastmessageTime:n.lastmessageTime,companionName:n.companionName,onClickFunc:n.onClickFunc}))}return t}return[]}()),i=Object(x.a)(t,2),r=i[0],o=i[1],s=c.a.createRef();function l(t){return{key:a,id:a,indicator:0,lastmessageText:"",lastmessageTime:"",companionName:t.companion,onClickFunc:e.openChatFunc}}return c.a.createElement("div",{className:g.a.chatlistcontent,ref:s},c.a.createElement("button",{className:g.a.createchat,onClick:function(){var e=prompt("Enter name"),t={id:a,companion:e,messages:[]};!function(e){var a=l(e);s.current.scrollIntoView(),o(r.concat(c.a.createElement(w,{key:a.key,id:a.id,indicator:a.indicator,lastmessageText:a.lastmessageText,lastmessageTime:a.lastmessageTime,companionName:a.companionName,onClickFunc:a.onClickFunc})))}(t),function(e){var a=JSON.parse(localStorage.getItem(S));null===a&&(a=[]);a.push(e),localStorage.setItem(S,JSON.stringify(a))}(t),a+=1}},c.a.createElement("img",{className:g.a.createchaticon,src:T.a,alt:"create"})),r)};var D=function(e){return c.a.createElement("div",{className:g.a.chat_list},c.a.createElement(y,null),c.a.createElement(j,null))},C=t(20),I=t.n(C),R=t(1),F=t.n(R),V=t(16),J=t.n(V),U=t(30),A=t.n(U);var L=function(){return c.a.createElement("div",{className:F.a.conv_head},c.a.createElement("div",{className:F.a.top_line},c.a.createElement(p.b,{to:"/",className:F.a.back},c.a.createElement("img",{className:F.a.back_icon,src:J.a,alt:"back"})),c.a.createElement("div",{className:F.a.interlocutor},c.a.createElement("img",{className:F.a.interlocutor_icon,src:k.a,alt:"user"}),c.a.createElement("div",{className:F.a.interlocutor_info},c.a.createElement("div",{className:F.a.interlocutor_name},"Name"),c.a.createElement("div",{className:F.a.interlocutor_time},"last seen 2 hours ago"))),c.a.createElement("button",{className:F.a.search},c.a.createElement("img",{className:F.a.search_icon,src:E.a,alt:"search"})),c.a.createElement("button",{className:F.a.more},c.a.createElement("img",{className:F.a.more_icon,src:A.a,alt:"more"}))))},P=t(31),K=t.n(P),G=t(32),z=t.n(G),B=t(33),X=t.n(B),W=t(34),Q=t.n(W),q=t(35),H=t.n(q);var M=function(e){return c.a.createElement("div",{className:F.a.form_input},c.a.createElement("div",{className:F.a.line_block},c.a.createElement("input",{type:"text",onChange:e.onChange,value:e.value,id:"fileList",onDragOver:e.onDragOver,onDrop:e.onDrop,onDragEnter:function(e){e.target.style.background="darkolivegreen",e.stopPropagation(),e.preventDefault()},onDragLeave:function(e){e.target.style.background="",e.stopPropagation(),e.preventDefault()}}),c.a.createElement("div",{className:F.a.buttons},c.a.createElement("button",{className:F.a.attach,onClick:e.onAudioStart,id:"audio",style:{display:e.audioStatus.micDisplay}},c.a.createElement("img",{className:F.a.attach_icon,src:Q.a,alt:"audio"})),c.a.createElement("button",{className:F.a.attach,onClick:e.onAudioStop,style:{display:e.audioStatus.stopDisplay}},c.a.createElement("img",{className:F.a.attach_icon,src:H.a,alt:"stop"})),c.a.createElement("button",{className:F.a.attach,onClick:e.onGeo},c.a.createElement("img",{className:F.a.attach_icon,src:X.a,alt:"geo"})),c.a.createElement("input",{type:"file",id:"fileElem",accept:"image/*",style:{display:"none"},onChange:e.onChange}),c.a.createElement("label",{htmlFor:"fileElem"},c.a.createElement("button",{className:F.a.attach},c.a.createElement("label",{htmlFor:"fileElem"},c.a.createElement("img",{className:F.a.attach_icon,src:z.a,alt:"attach"})))),c.a.createElement("button",{className:F.a.send,onClick:e.onSend},c.a.createElement("img",{className:F.a.send_icon,src:K.a,alt:"send"})))))};var Y=function(e){var a="none";return""!==e.audio_src&&(a="flex"),c.a.createElement("div",{className:F.a.message_form,id:e.id},c.a.createElement("div",{className:F.a.bubble},c.a.createElement("div",{className:F.a.text},e.messageText,c.a.createElement("img",{src:e.img_src,alt:"",width:"100%"}),c.a.createElement("audio",{src:e.audio_src,alt:"",width:"100%",controls:!0,style:{display:a}})),c.a.createElement("div",{className:F.a.time},e.messageTime)))},Z="",$="",ee=1048576;var ae=function(e){var a=Object(o.f)().chatId,t=0,i=0,r=c.a.useRef(null),s=Object(n.useState)(""),l=Object(x.a)(s,2),m=l[0],_=l[1],u=Object(n.useState)(function(){var e=JSON.parse(localStorage.getItem(a));if(null!==e){for(var n=[];i<e.length;i+=1){var r=O(e[i]);n.push(c.a.createElement(Y,{img_src:r.img_src,audio_src:r.audio_src,key:r.key,id:r.id,messageText:r.messageText,messageTime:r.messageTime,companionName:r.companionName})),i===e.length-1&&(t=i)}return setTimeout((function(){document.getElementById(t).scrollIntoView()}),0),n}return[]}()),d=Object(x.a)(u,2),p=d[0],f=d[1],g=Object(n.useState)({display:"none"}),h=Object(x.a)(g,2),b=h[0],v=h[1],E=Object(n.useState)({micDisplay:"flex",stopDisplay:"none"}),N=Object(x.a)(E,2),k=N[0],y=N[1];function w(e){if(""!==(Z=window.URL.createObjectURL(e))){v({display:"inline"});var t=new FormData;t.append("file",e),t.append("chat_id",a),e.size<4*ee?fetch("https://tt-front.now.sh/upload",{method:"POST",body:t}):alert("File`s size must be less than 4 Mb")}}function O(e){return{img_src:e.img_src,audio_src:e.audio_src,key:i,id:i,messageText:e.messageText,messageTime:new Date(e.messageTime).toTimeString().slice(0,5),companionName:e.companion}}function T(){if(""!==m||""!==Z||""!==$){var t={img_src:Z,audio_src:$,key:i,companion:e.companionName,messageText:m,messageTime:new Date};!function(e){var a=O(e);f(p.concat(c.a.createElement(Y,{img_src:a.img_src,audio_src:a.audio_src,key:a.key,id:a.id,messageText:a.messageText,messageTime:a.messageTime,companionName:a.companionName})))}(t),function(e){var t=JSON.parse(localStorage.getItem(a));null===t&&(t=[]);t.push(e),localStorage.setItem(+a,JSON.stringify(t))}(t),i+=1,_(""),v({display:"none"}),Z="",$="",window.URL.revokeObjectURL(Z)}}var S=function(e){e.stopPropagation(),e.preventDefault()};return c.a.createElement("div",{className:F.a.conv_window,onKeyPress:function(e){"Enter"===e.key&&T()}},c.a.createElement(L,null),c.a.createElement("div",{className:F.a.message_container},p),c.a.createElement("span",{style:{display:b.display,position:"fixed",top:"calc(100% - 49px)",left:"calc(100% - 106px)",height:"5px",width:"5px",backgroundColor:"rgb(24, 58, 55)",borderRadius:"100%"}}),c.a.createElement(M,{audioStatus:k,onAudioStart:function(e){y({micDisplay:"none",stopDisplay:"flex"}),function(){var e,a;I.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e={audio:!0},t.next=4,I.a.awrap(navigator.mediaDevices.getUserMedia(e));case 4:a=t.sent,r.current=new MediaRecorder(a),r.current.start(),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),alert("Failed to get audio");case 12:case"end":return t.stop()}}),null,null,[[0,9]])}()},onAudioStop:function(e){y({micDisplay:"flex",stopDisplay:"none"}),r.current.stop();var a=[];r.current.addEventListener("stop",(function(e){var t=new Blob(a,{type:r.mimeType});a=[],$=URL.createObjectURL(t),T()})),r.current.addEventListener("dataavailable",(function(t){a.push(e.data)}))},onDragOver:S,onDrop:function(e){S(e),w(e.dataTransfer.files[0]),e.target.style.backgroundColor=""},onChange:function(e){"file"===e.target.type?(w(e.target.files[0]),e.target.value=""):_(e.target.value)},value:m,onSend:T,onGeo:function(e){"geolocation"in navigator?navigator.geolocation.getCurrentPosition((function(e){_("https://www.openstreetmap.org/#map=18/".concat(e.coords.latitude,"/").concat(e.coords.longitude))})):alert("Geolocation is not available in your browser")}}))},te=t(4),ne=t.n(te),ce=t(36),ie=t.n(ce),re="UserId";var oe=function(e){var a=Object(n.useState)(function(){var e=JSON.parse(localStorage.getItem(re));if(null!==e)return{name:e.name,username:e.username,bio:e.bio};return{name:"",username:"",bio:""}}()),t=Object(x.a)(a,2),i=t[0],r=t[1],o=c.a.createRef(),s=c.a.createRef(),l=c.a.createRef(),m=c.a.createElement("button",{className:ne.a.edit,onClick:function(){y({edit:!0,headbutton:_,username:g,name:b,bio:h})}},c.a.createElement("img",{className:ne.a.edit_icon,src:T.a,alt:"edit"})),_=c.a.createElement("button",{className:ne.a.tick,onClick:function(){var e={name:o.current.value,username:s.current.value,bio:l.current.value};a=e,localStorage.setItem(re,JSON.stringify(a)),r(e),y({edit:!1,headbutton:m,username:d(e.username),name:u(e.name),bio:f(e.bio)});var a}},c.a.createElement("img",{className:ne.a.tick_icon,src:ie.a,alt:"tick"})),u=function(e){return c.a.createElement("div",{className:ne.a.nameViewer},e)},d=function(e){return c.a.createElement("div",{className:ne.a.usernameViewer},e)},f=function(e){return c.a.createElement("div",{className:ne.a.bioViewer},e)},g=c.a.createElement("input",{placeholder:"Username",ref:s}),h=c.a.createElement("input",{placeholder:"Biography",ref:l}),b=c.a.createElement("input",{placeholder:"Full Name",ref:o}),v=Object(n.useState)({edit:!1,headbutton:m,username:d(i.username),name:u(i.name),bio:f(i.bio)}),E=Object(x.a)(v,2),N=E[0],y=E[1];return c.a.createElement("div",{className:ne.a.profile_manager},c.a.createElement("div",{className:ne.a.top_line},c.a.createElement(p.b,{to:"/",className:ne.a.back},c.a.createElement("img",{className:ne.a.back_icon,src:J.a,alt:"back"})),N.headbutton),c.a.createElement("div",{className:ne.a.profile_content},c.a.createElement("div",{className:ne.a.photo},c.a.createElement("img",{className:ne.a.photo_icon,src:k.a,alt:"profile_photo"})),c.a.createElement("div",{className:ne.a.full_name},N.name),c.a.createElement("div",{className:ne.a.username},N.username),c.a.createElement("div",{className:ne.a.bio},N.bio)))},se=function(e){function a(){return Object(l.a)(this,a),Object(_.a)(this,Object(u.a)(a).apply(this,arguments))}return Object(d.a)(a,e),Object(m.a)(a,[{key:"render",value:function(){return c.a.createElement(p.a,null,c.a.createElement(o.c,null,c.a.createElement(o.a,{path:"/chat_id=:chatId"},c.a.createElement(ae,null)),c.a.createElement(o.a,{path:"/profile"},c.a.createElement(oe,null)),c.a.createElement(o.a,{path:"/"},c.a.createElement(D,null))))}}]),a}(c.a.Component);t(50);t.d(a,"history",(function(){return le}));var le=Object(s.a)();r.a.render(c.a.createElement(o.b,{history:le},c.a.createElement(se,null)),document.getElementById("root"))}],[[39,1,2]]]);
//# sourceMappingURL=main.611fee9f.chunk.js.map